<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>Assert Same Relationship</title>
<style>body { font-family: Arial, sans-serif; max-width: 1200px; margin: 20px auto; padding: 0 20px; }</style>
</head>
<body>
<p><strong>类别:</strong> Data modification operators</p>
<p><strong>来源:</strong> <a href='https://neo4j.com/docs/cypher-manual/25/planning-and-tuning/operators/operators-detail/#query-plan-assert-same-relationship'>https://neo4j.com/docs/cypher-manual/25/planning-and-tuning/operators/operators-detail/#query-plan-assert-same-relationship</a></p>
<hr>
<h3 id="query-plan-assert-same-relationship"><a class="anchor" href="#query-plan-assert-same-relationship"></a>Assert Same Relationship</h3>
<div class="paragraph">
<p>The <code>AssertSameRelationship</code> operator is used to ensure that no relationship property uniqueness constraints are violated in the slotted and interpreted runtime.
The example looks for the presence of a <code>WORKS_IN</code> relationship with the supplied  <code>id</code> and <code>badgeNumber</code>.
If it can’t be found, then it will be created.
Owing to the existence of two property uniqueness constraints on <code>:WORKS_IN(id)</code> and <code>:WORKS_IN(badgeNumber)</code>, any relationship that would be found by the <code>DirectedRelationshipUniqueIndexSeek</code> operator must be the very same relationship or the constraints would be violated.</p>
</div>
<div class="exampleblock">
<div class="title">Example 126. AssertSameRelationship</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">PROFILE
CYPHER runtime=slotted
MERGE (person)-[work:WORKS_IN {id: 0, badgeNumber: 4332}]-&gt;(location)</code></pre>
</div>
</div>
<div class="listingblock queryplan">
<div class="title">Query Plan</div>
<div class="content">
<pre>Planner COST

Runtime SLOTTED

Runtime version 2025.11

+-------------------------------------------------+----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| Operator                                        | Id | Details                                                                                              | Estimated Rows | Rows | DB Hits | Page Cache Hits/Misses |
+-------------------------------------------------+----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| +ProduceResults                                 |  0 |                                                                                                      |              1 |    0 |       0 |                    0/0 |
| |                                               +----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| +EmptyResult                                    |  1 |                                                                                                      |              1 |    0 |       0 |                    0/0 |
| |                                               +----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| +Merge                                          |  2 | CREATE (person), (location), (person)-[work:WORKS_IN {id: $autoint_0, badgeNumber: $autoint_1}]-&gt;(lo |              1 |    1 |       0 |                    0/0 |
| |                                               |    | cation)                                                                                              |                |      |         |                        |
| |                                               +----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| +AssertSameRelationship                         |  3 | work                                                                                                 |              0 |    1 |       0 |                    0/0 |
| |\                                              +----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| | +DirectedRelationshipUniqueIndexSeek(Locking) |  4 | RANGE INDEX (person)-[work:WORKS_IN(badgeNumber)]-&gt;(location) WHERE badgeNumber = $autoint_1         |              1 |    1 |       1 |                    0/1 |
| |                                               +----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+
| +DirectedRelationshipUniqueIndexSeek(Locking)   |  5 | RANGE INDEX (person)-[work:WORKS_IN(id)]-&gt;(location) WHERE id = $autoint_0                           |              1 |    1 |       1 |                    1/1 |
+-------------------------------------------------+----+------------------------------------------------------------------------------------------------------+----------------+------+---------+------------------------+

Total database accesses: 2, total allocated memory: 64</pre>
</div>
</div>
</div>
</div>
</body>
</html>
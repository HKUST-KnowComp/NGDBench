[
    {
        "query_id": "read1",
        "query_type": "multi-hop-transfer-blocked-medium",
        "query_template": "MATCH p = (acc:Account {id:%d})-[e1:transfer *1..3]->(other:Account)<-[e2:signIn]-(medium) WHERE isAsc(getMemberProp(e1, 'timestamp'))=true AND head(getMemberProp(e1, 'timestamp')) > %d AND last(getMemberProp(e1, 'timestamp')) < %d AND e2.timestamp > %d AND e2.timestamp < %d AND medium.isBlocked = true RETURN DISTINCT other.id as otherId, length(p)-1 as accountDistance, medium.id as mediumId, medium.type as mediumType ORDER BY accountDistance, otherId, mediumId;",
        "query_parameters": {
            "acc_id": "账户ID",
            "transfer_start_time": "转账起始时间",
            "transfer_end_time": "转账结束时间",
            "signin_start_time": "登录起始时间",
            "signin_end_time": "登录结束时间"
        },
        "nl": "从给定账户出发，找到通过1-3步转账可达的其他账户（转账时间戳需递增且在指定时间窗口内），筛选出被封锁媒介在另一时间窗口内登录过的账户，返回账户ID、转账距离、媒介ID和类型"
    },
    {
        "query_id": "read2",
        "query_type": "person-account-transfer-loan",
        "query_template": "MATCH (p:Person {id:%d})-[e1:own]->(acc:Account) <-[e2:transfer*1..3]-(other:Account) WHERE isDesc(getMemberProp(e2, 'timestamp'))=true AND head(getMemberProp(e2, 'timestamp')) < %d AND last(getMemberProp(e2, 'timestamp')) > %d WITH DISTINCT other MATCH (other)<-[e3:deposit]-(loan:Loan) WHERE e3.timestamp > %d AND e3.timestamp < %d WITH DISTINCT other.id AS otherId, loan.loanAmount AS loanAmount, loan.balance AS loanBalance WITH otherId AS otherId, sum(loanAmount) as sumLoanAmount, sum(loanBalance) as sumLoanBalance RETURN otherId, round(sumLoanAmount * 1000) / 1000 as sumLoanAmount, round(sumLoanBalance * 1000) / 1000 as sumLoanBalance ORDER BY sumLoanAmount DESC, otherId ASC;",
        "query_parameters": {
            "person_id": "人员ID",
            "transfer_start_time": "转账起始时间",
            "transfer_end_time": "转账结束时间",
            "deposit_start_time": "存款起始时间",
            "deposit_end_time": "存款结束时间"
        },
        "nl": "从给定人员出发，找到其拥有的账户，追溯1-3步反向转账（时间戳严格递减），找到这些账户收到的贷款存款，汇总每个账户的贷款金额和余额"
    },
    {
        "query_id": "read3",
        "query_type": "shortest-path",
        "query_template": "MATCH (src:Account{id:%d}), (dst:Account{id:%d}) CALL algo.shortestPath( src, dst, { direction: 'PointingRight', relationshipQuery:'transfer', edgeFilter: { timestamp: { smaller_than: %d, greater_than: %d } } } ) YIELD nodeCount RETURN nodeCount - 1 AS len;",
        "query_parameters": {
            "src_id": "源账户ID",
            "dst_id": "目标账户ID",
            "timestamp_upper": "时间戳上界",
            "timestamp_lower": "时间戳下界"
        },
        "nl": "计算从源账户到目标账户的最短转账路径长度，只使用时间戳在指定窗口内的转账边"
    },
    {
        "query_id": "read4",
        "query_type": "intermediate-account-transfer-stats",
        "query_template": "MATCH (src:Account {id:%d})-[e1:transfer]->(dst:Account {id:%d}) WHERE e1.timestamp > %d AND e1.timestamp < %d WITH src, dst.id as dstid MATCH (src)<-[e2:transfer]-(other:Account)<-[e3:transfer]-(dst:Account) WHERE dst.id=dstid AND e2.timestamp > %d AND e2.timestamp < %d AND e3.timestamp > %d AND e3.timestamp < %d WITH DISTINCT src, other, dst MATCH (src)<-[e2:transfer]-(other) WHERE e2.timestamp > %d AND e2.timestamp < %d WITH src, other, dst, count(e2) as numEdge2, sum(e2.amount) as sumEdge2Amount, max(e2.amount) as maxEdge2Amount MATCH (other)<-[e3:transfer]-(dst) WHERE e3.timestamp > %d AND e3.timestamp < %d WITH other.id as otherId, numEdge2, sumEdge2Amount, maxEdge2Amount, count(e3) as numEdge3, sum(e3.amount) as sumEdge3Amount, max(e3.amount) as maxEdge3Amount RETURN otherId, numEdge2, round(sumEdge2Amount * 1000) / 1000 as sumEdge2Amount, round(maxEdge2Amount * 1000) / 1000 as maxEdge2Amount, numEdge3, round(sumEdge3Amount * 1000) / 1000 as sumEdge3Amount, round(maxEdge3Amount * 1000) / 1000 as maxEdge3Amount ORDER BY sumEdge2Amount DESC, sumEdge3Amount DESC, otherId ASC;",
        "query_parameters": {
            "src_id": "源账户ID",
            "dst_id": "目标账户ID",
            "direct_transfer_start": "直接转账起始时间",
            "direct_transfer_end": "直接转账结束时间",
            "e2_start_time_1": "中间转账e2起始时间1",
            "e2_end_time_1": "中间转账e2结束时间1",
            "e3_start_time_1": "中间转账e3起始时间1",
            "e3_end_time_1": "中间转账e3结束时间1",
            "e2_start_time_2": "中间转账e2起始时间2",
            "e2_end_time_2": "中间转账e2结束时间2",
            "e3_start_time_2": "中间转账e3起始时间2",
            "e3_end_time_2": "中间转账e3结束时间2"
        },
        "nl": "找到源账户和目标账户之间的直接转账，然后找所有同时向源账户转账和从目标账户接收转账的中间账户，统计转账次数、金额总和和最大金额"
    },
    {
        "query_id": "read5",
        "query_type": "transfer-path-no-duplicate",
        "query_template": "MATCH (person:Person {id:%d})-[e1:own]->(src:Account) WITH src MATCH p=(src)-[e2:transfer*1..3]->(dst:Account) WHERE isAsc(getMemberProp(e2, 'timestamp'))=true AND head(getMemberProp(e2, 'timestamp')) > %d AND last(getMemberProp(e2, 'timestamp')) < %d WITH DISTINCT getMemberProp(nodes(p), 'id') as path, length(p) as len ORDER BY len DESC WHERE hasDuplicates(path)=false RETURN path;",
        "query_parameters": {
            "person_id": "人员ID",
            "transfer_start_time": "转账起始时间",
            "transfer_end_time": "转账结束时间"
        },
        "nl": "从给定人员拥有的账户出发，找到所有1-3步转账路径（时间戳严格递增且在指定窗口内），只返回无重复账户的路径，按路径长度降序排序"
    },
    {
        "query_id": "read6",
        "query_type": "card-withdraw-transfer-stats",
        "query_template": "MATCH (dstCard:Account {id:%d} )<-[edge2:withdraw]-(mid:Account) WHERE dstCard.type ENDS WITH 'card' AND edge2.timestamp > %d AND edge2.timestamp < %d AND edge2.amount > %f WITH mid, sum(edge2.amount) as sumEdge2Amount, count(edge2.amount) as t MATCH (mid)<-[edge1:transfer]-(src:Account) WHERE edge1.timestamp > %d AND edge1.timestamp < %d AND edge1.amount > %f WITH mid.id AS midId, count(edge1) AS edge1Count, sum(edge1.amount) AS sumEdge1Amount, sumEdge2Amount WHERE edge1Count > 3 WITH midId, sumEdge1Amount, sumEdge2Amount RETURN midId, round(sumEdge1Amount * 1000) / 1000 as sumEdge1Amount, round(sumEdge2Amount * 1000) / 1000 as sumEdge2Amount ORDER BY sumEdge2Amount DESC;",
        "query_parameters": {
            "card_id": "卡账户ID",
            "withdraw_start_time": "提现起始时间",
            "withdraw_end_time": "提现结束时间",
            "withdraw_amount_threshold": "提现金额阈值",
            "transfer_start_time": "转账起始时间",
            "transfer_end_time": "转账结束时间",
            "transfer_amount_threshold": "转账金额阈值"
        },
        "nl": "找到向指定卡账户提现的中间账户，筛选提现金额超过阈值且转入次数超过3次的账户，返回转账和提现金额汇总"
    },
    {
        "query_id": "read7",
        "query_type": "account-transfer-in-out-ratio",
        "query_template": "MATCH (mid:Account {id:%d}) WITH mid OPTIONAL MATCH (mid)-[edge2:transfer]->(dst:Account) WHERE edge2.timestamp > %d AND edge2.timestamp < %d AND edge2.amount > %f WITH mid, count(distinct dst) as numDst, sum(edge2.amount) as amountDst OPTIONAL MATCH (mid)<-[edge1:transfer]-(src:Account) WHERE edge1.timestamp > %d AND edge1.timestamp < %d AND edge1.amount > %f WITH count(distinct src) as numSrc, sum(edge1.amount) as amountSrc, numDst, amountDst RETURN numSrc, numDst, CASE WHEN amountDst=0 THEN -1 ELSE round(1000.0 * amountSrc / amountDst) / 1000 END AS inOutRatio;",
        "query_parameters": {
            "account_id": "账户ID",
            "out_start_time": "转出起始时间",
            "out_end_time": "转出结束时间",
            "out_amount_threshold": "转出金额阈值",
            "in_start_time": "转入起始时间",
            "in_end_time": "转入结束时间",
            "in_amount_threshold": "转入金额阈值"
        },
        "nl": "统计指定账户的转入和转出情况，计算转入转出金额比率"
    },
    {
        "query_id": "read8",
        "query_type": "plugin-tcr8",
        "query_template": "CALL plugin.cpp.tcr8({ id:%d, threshold: %f, startTime: %d, endTime: %d, limit: %d });",
        "query_parameters": {
            "id": "ID",
            "threshold": "阈值",
            "startTime": "起始时间",
            "endTime": "结束时间",
            "limit": "限制数量"
        },
        "nl": "调用TCR8插件执行特定查询"
    },
    {
        "query_id": "read9",
        "query_type": "account-loan-transfer-ratio",
        "query_template": "MATCH (mid:Account {id:%d}) WITH mid OPTIONAL MATCH (mid)-[edge2:repay]->(loan:Loan) WHERE edge2.amount > %f AND edge2.timestamp > %d AND edge2.timestamp < %d WITH mid, sum(edge2.amount) AS edge2Amount OPTIONAL MATCH (mid)<-[edge1:deposit]-(loan:Loan) WHERE edge1.amount > %f AND edge1.timestamp > %d AND edge1.timestamp < %d WITH mid, sum(edge1.amount) AS edge1Amount, edge2Amount OPTIONAL MATCH (mid)-[edge4:transfer]->(down:Account) WHERE edge4.amount > %f AND edge4.timestamp > %d AND edge4.timestamp < %d WITH mid, edge1Amount, edge2Amount, sum(edge4.amount) AS edge4Amount OPTIONAL MATCH (mid)<-[edge3:transfer]-(up:Account) WHERE edge3.amount > %f AND edge3.timestamp > %d AND edge3.timestamp < %d WITH edge1Amount, edge2Amount, sum(edge3.amount) AS edge3Amount, edge4Amount RETURN CASE WHEN edge2Amount=0 THEN -1 ELSE round(1000.0 * edge1Amount / edge2Amount) / 1000 END AS ratioRepay, CASE WHEN edge4Amount=0 THEN -1 ELSE round(1000.0 * edge1Amount / edge4Amount) / 1000 END AS ratioDeposit, CASE WHEN edge4Amount=0 THEN -1 ELSE round(1000.0 * edge3Amount / edge4Amount) / 1000 END AS ratioTransfer;",
        "query_parameters": {
            "account_id": "账户ID",
            "repay_amount_threshold": "还款金额阈值",
            "repay_start_time": "还款起始时间",
            "repay_end_time": "还款结束时间",
            "deposit_amount_threshold": "存款金额阈值",
            "deposit_start_time": "存款起始时间",
            "deposit_end_time": "存款结束时间",
            "out_transfer_amount_threshold": "转出金额阈值",
            "out_transfer_start_time": "转出起始时间",
            "out_transfer_end_time": "转出结束时间",
            "in_transfer_amount_threshold": "转入金额阈值",
            "in_transfer_start_time": "转入起始时间",
            "in_transfer_end_time": "转入结束时间"
        },
        "nl": "计算指定账户的贷款存款/还款比率、存款/转出比率、转入/转出比率"
    },
    {
        "query_id": "read10",
        "query_type": "person-investment-jaccard-similarity",
        "query_template": "OPTIONAL MATCH (p1:Person {id:%d})-[edge1:invest]->(m1:Company) WHERE edge1.timestamp > %d AND edge1.timestamp < %d WITH collect(distinct id(m1)) as m1_vids OPTIONAL MATCH (p2:Person {id:%d})-[edge2:invest]->(m2:Company) WHERE edge2.timestamp > %d AND edge2.timestamp < %d WITH collect(distinct id(m2)) as m2_vids, m1_vids CALL algo.jaccard(m1_vids, m2_vids) YIELD similarity RETURN CASE WHEN similarity = null THEN 0 ELSE round(similarity*1000)/1000 END AS similarity;",
        "query_parameters": {
            "person1_id": "人员1的ID",
            "p1_invest_start_time": "人员1投资起始时间",
            "p1_invest_end_time": "人员1投资结束时间",
            "person2_id": "人员2的ID",
            "p2_invest_start_time": "人员2投资起始时间",
            "p2_invest_end_time": "人员2投资结束时间"
        },
        "nl": "计算两个人在指定时间窗口内投资公司的Jaccard相似度"
    },
    {
        "query_id": "read11",
        "query_type": "guarantee-chain-loan-stats",
        "query_template": "OPTIONAL MATCH (p1:Person {id:%d})-[edge:guarantee*1..5]->(pN:Person) -[:apply]->(loan:Loan) WHERE minInList(getMemberProp(edge, 'timestamp')) > %d AND maxInList(getMemberProp(edge, 'timestamp')) < %d WITH DISTINCT loan WITH sum(loan.loanAmount) as sumLoanAmount, count(distinct loan) as numLoans RETURN round(sumLoanAmount * 1000) / 1000 as sumLoanAmount, numLoans;",
        "query_parameters": {
            "person_id": "人员ID",
            "guarantee_start_time": "担保起始时间",
            "guarantee_end_time": "担保结束时间"
        },
        "nl": "从给定人员出发，沿1-5步担保链找到申请的贷款，统计贷款总金额和数量"
    },
    {
        "query_id": "read12",
        "query_type": "person-to-company-transfer-stats",
        "query_template": "MATCH (person:Person {id:%d})-[edge1:own]->(pAcc:Account) -[edge2:transfer]->(compAcc:Account) <-[edge3:own]-(com:Company) WHERE edge2.timestamp > %d AND edge2.timestamp < %d WITH compAcc.id AS compAccountId, sum(edge2.amount) AS sumEdge2Amount RETURN compAccountId, round(sumEdge2Amount * 1000) / 1000 as sumEdge2Amount ORDER BY sumEdge2Amount DESC;",
        "query_parameters": {
            "person_id": "人员ID",
            "transfer_start_time": "转账起始时间",
            "transfer_end_time": "转账结束时间"
        },
        "nl": "找到给定人员拥有的账户向公司账户的转账，按公司账户汇总转账金额并降序排序"
    },
    {
        "query_id": "simple_read1",
        "query_type": "account-basic-info",
        "query_template": "MATCH (n:Account{id:%d}) RETURN n.createTime as createTime, n.isBlocked as isBlocked, n.type as type;",
        "query_parameters": {
            "account_id": "账户ID"
        },
        "nl": "查询指定账户的基本信息：创建时间、是否被封锁、账户类型"
    },
    {
        "query_id": "simple_read2",
        "query_type": "account-transfer-stats",
        "query_template": "MATCH (n:Account{id:%d}) WITH n OPTIONAL MATCH (n)-[e:transfer]->(m:Account) WHERE e.timestamp > %d AND e.timestamp < %d WITH n, sum(e.amount) as sumEdge1Amount, max(e.amount) as maxEdge1Amount, count(e) as numEdge1 OPTIONAL MATCH (n)<-[e:transfer]-(m:Account) WHERE e.timestamp > %d AND e.timestamp < %d WITH sumEdge1Amount, maxEdge1Amount, numEdge1, sum(e.amount) as sumEdge2Amount, max(e.amount) as maxEdge2Amount, count(e) as numEdge2 RETURN round(sumEdge1Amount * 1000) / 1000 as sumEdge1Amount, CASE WHEN maxEdge1Amount < 0 THEN -1 ELSE round(maxEdge1Amount * 1000) / 1000 END as maxEdge1Amount, numEdge1, round(sumEdge2Amount * 1000) / 1000 as sumEdge2Amount, CASE WHEN maxEdge2Amount < 0 THEN -1 ELSE round(maxEdge2Amount * 1000) / 1000 END as maxEdge2Amount, numEdge2;",
        "query_parameters": {
            "account_id": "账户ID",
            "out_start_time": "转出起始时间",
            "out_end_time": "转出结束时间",
            "in_start_time": "转入起始时间",
            "in_end_time": "转入结束时间"
        },
        "nl": "统计指定账户在时间窗口内的转入转出情况：金额总和、最大金额、转账次数"
    },
    {
        "query_id": "simple_read3",
        "query_type": "blocked-account-transfer-ratio",
        "query_template": "OPTIONAL MATCH (n:Account{id:%d})<-[e:transfer]-(m:Account) WHERE e.amount > %f AND e.timestamp > %d AND e.timestamp < %d AND m.isBlocked=true WITH count(m) * 1.0 as numM OPTIONAL MATCH (n:Account{id:%d})<-[e:transfer]-(m:Account) WITH count(m) as numIn, numM RETURN CASE WHEN numIn = 0 THEN -1 ELSE round(numM / numIn * 1000) / 1000 END as blockRatio;",
        "query_parameters": {
            "account_id_1": "账户ID（第一次查询）",
            "amount_threshold": "金额阈值",
            "transfer_start_time": "转账起始时间",
            "transfer_end_time": "转账结束时间",
            "account_id_2": "账户ID（第二次查询）"
        },
        "nl": "计算向指定账户转账的被封锁账户占比（封锁账户数/总转入账户数）"
    }
]
